<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>비밀번호 찾기</title>
<link rel="stylesheet" th:href="@{/css/logindefault.css}">
<script type="text/javascript" src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script type="text/javascript">

	document.addEventListener("DOMContentLoaded", function() {
	    const phoneInput = document.getElementById("phone");
	    const phoneError = document.getElementById("phoneError");

	    // 입력 도중 체크
	    phoneInput.addEventListener("input", function() {
	        const cleaned = this.value.replace(/[^0-9]/g, ''); // 숫자만 허용
	        if(this.value !== cleaned){
	            this.value = cleaned;
	            phoneError.style.display = "block";
	        } else {
	            phoneError.style.display = "none";
	        }
	    });

	    // 폼 제출 전 최종 체크
	    const form = document.getElementById("inputForm");
	    form.addEventListener("submit", function(event){
	        if(!/^[0-9]*$/.test(phoneInput.value)){
	            event.preventDefault();
	            phoneError.style.display = "block";
	            phoneInput.focus();
	        }
	    });
	});
	
</script>
</head>
<body>

	<div id="container">
		<h1>비밀번호 찾기</h1>

		<form id="inputForm" th:action="@{/api/user/findPw}" action="/api/user/findPw" method="post" th:object="${findPassword}">
		    <div>
		        <label for="userId">아이디</label>
		        <input type="text" th:field="*{userId}" id="userId" name="userId" placeholder="아이디를 입력해주세요.">
				<p th:if="${#fields.hasErrors('userId')}" 
				           th:errors="*{userId}" style="color:#bd2130;"></p>
		    </div>
		    <div>
		        <label for="userPhone">전화번호</label>
		        <input type="text" th:field="*{phone}" id="phone" name="phone" placeholder="전화번호를 입력해주세요(숫자만).">
				<p th:if="${#fields.hasErrors('phone')}" 
				           th:errors="*{phone}" style="color:#bd2130;"></p>
				<p id="phoneError" style="color:#bd2130; display:none;">숫자만 입력 가능합니다.</p>
		    </div>
		    <button type="submit">비밀번호 찾기</button>
		</form>
		
		<div class="links">
			<a href="/api/user/login">로그인 페이지로 가기</a>&nbsp;&nbsp;|&nbsp;&nbsp;
			<a href="/api/user/findId">아이디 찾기</a>
		</div>
	</div>

</body>
</html>
