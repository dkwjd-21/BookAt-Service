<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <title>Bookat 결제완료</title>
  <link rel="stylesheet" th:href="@{/css/header.css}" />
  <link rel="stylesheet" th:href="@{/css/footer.css}" />
  <link rel="stylesheet" th:href="@{/css/payment.css}" />
  	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script th:src="@{/js/utils/axiosIntercepter.js}"></script>
	<script th:src="@{/js/utils/logout.js}"></script>
	<script th:src="@{/js/utils/userAuth.js}"></script>
	<script th:src="@{/js/utils/header.js}"></script>
</head>
<body style="background-color:#f0f2f5;">
<main class="container payment-complete">

  <!-- 상단 완료/상태 영역 -->
  <section class="panel panel--success" 
           th:classappend="${order.orderStatus == 1} ? '' : ' panel--neutral'">
    <div class="success-head">
      <svg class="icon-check" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"></path>
      </svg>
      <div>
        <h1 class="title">
          <span th:if="${order.orderStatus == 1}">결제가 완료되었습니다</span>
          <span th:unless="${order.orderStatus == 1}">주문 상태</span>
        </h1>
        <p class="meta">
          주문번호 <strong th:text="${order.orderId}">2025-000001</strong>
          · 주문일시 <span th:text="${#temporals.format(order.orderDate, 'yyyy.MM.dd HH:mm')}">2025.09.18 10:30</span>
          · 상태 
          <span class="status-badge" 
                th:text="${@orderStatusLabel.of(order.orderStatus)}">결제완료</span>
        </p>
      </div>
    </div>
  </section>

  <!-- 주문 상품 리스트 -->
  <section class="panel">
    <div class="panel-head">
      <h2 class="section-title">
        주문 상품 
        <span class="badge" th:text="${totalQty} + '개'">3개</span>
      </h2>
    </div>

    <ul class="item-list" role="list">
      <!-- orderItems : ORDER_ITEM + BOOK 조인 결과를 가정 -->
      <li class="item" th:each="it : ${orderItems}">
        <a class="thumb" th:href="@{|/books/${it.bookId}|}">
          <img th:src="${it.coverUrl != null ? it.coverUrl : '/images/placeholder-book.png'}"
               alt="" loading="lazy">
        </a>
        <div class="item-info">
          <a class="item-title" th:href="@{|/books/${it.bookId}|}"
             th:text="${it.bookTitle != null ? it.bookTitle : it.bookId}">도서명</a>
          <div class="item-sub">
            수량 <span th:text="${it.orderQuantity}">1</span>개
            · 단가 <strong th:text="${#numbers.formatInteger(it.itemPrice)}">15,000</strong>원
            · 금액 
            <strong th:text="${#numbers.formatInteger(it.itemPrice * it.orderQuantity)}">15,000</strong>원
          </div>
        </div>
      </li>
    </ul>
  </section>

  <!-- 결제/배송 요약 -->
  <section class="panel">
    <div class="summary">
      <div class="summary-row">
        <span>상품 합계</span>
        <strong th:text="${#numbers.formatInteger(order.totalPrice)}">30,000</strong><span>원</span>
      </div>

      <!-- 필요하면 배송비/할인 등을 모델에 추가해서 표시 -->
      <div class="summary-divider"></div>

      <div class="summary-row total">
        <span>결제금액</span>
        <strong th:text="${#numbers.formatInteger(order.totalPrice)}">30,000</strong><span>원</span>
      </div>

      <div class="summary-sub">
        결제번호 
        <span th:text="${order.paymentId != null ? order.paymentId : '미결제/또는 확인 중'}">10001</span>
      </div>

      <div class="summary-sub" th:if="${estimatedDelivery != null}">
        예상 배송일 <strong th:text="${#temporals.format(estimatedDelivery, 'yyyy.MM.dd')}">2025.09.21</strong>
      </div>
    </div>

    <div class="action-row">
      <a class="btn btn--primary" th:href="@{|/orders/${order.orderId}|}">주문내역 보기</a>
      <a class="btn" th:href="@{/books}">도서 메인으로</a>
    </div>
  </section>
</main>
</body>
</html>